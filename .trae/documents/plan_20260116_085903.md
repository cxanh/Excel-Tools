## 问题分析

### 根因
当用户执行工作流程时，系统显示 "Buffer is not defined" 错误，这是因为：

- 在 `packages/renderer/src/utils/py.ts` 文件的第 124 行，代码使用了 `Buffer.from()` 方法
- `Buffer` 对象是 Node.js 的内置对象，在浏览器环境中不存在
- 当在浏览器中执行时，`Buffer` 未定义，导致错误

### 具体问题
```typescript
// 转换输入格式
const runPyInput: RunPyInput = {
  file: input.fileData ? Buffer.from(input.fileData, 'base64') : undefined,
  fileName: input.fileName || 'file.xlsx',
  params: input
}
```

## 修复方案

### 方案选择
**使用浏览器兼容的 base64 解码方法**：这是最优方案，因为：
- 只需修改一个文件，影响范围最小
- 保持代码逻辑不变，只是替换实现方式
- 完全兼容浏览器环境

### 具体修改
1. **修改 `runPythonScript` 函数**：
   - 替换 `Buffer.from()` 为浏览器兼容的实现
   - 使用 `atob()` 函数和 `Uint8Array` 来解码 base64 数据
   - 保持函数的返回值格式不变

2. **实现浏览器兼容的 base64 解码**：
   - 创建一个辅助函数来处理 base64 解码
   - 确保解码结果与 `Buffer` 相同，都是 `ArrayBuffer` 格式

### 修复后的预期效果
- 不再出现 "Buffer is not defined" 的错误
- 所有插件的 Python 脚本都能正常执行
- 保持与现有代码的兼容性
- 在浏览器和 Electron 环境中都能正常工作

## 实施步骤
1. 打开 `packages/renderer/src/utils/py.ts` 文件
2. 修改 `runPythonScript` 函数，实现浏览器兼容的 base64 解码
3. 保存修改并测试修复效果
4. 验证所有插件都能正常工作