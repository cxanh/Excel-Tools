## 问题分析

### 根因
当用户执行工作流程时，系统显示 "NameError: name 'remove' is not defined" 错误，这是因为：

- 在插件代码中，`runPythonScript` 函数被调用时传入的第一个参数是插件名称（如 `'remove-empty-row'`）
- 但在 `runPythonScript` 函数中，这个参数被直接作为 Python 脚本内容传递给 `runPy` 函数
- 当 Pyodide 执行这个字符串时，它会尝试将其作为 Python 代码执行，导致语法错误

### 具体问题
```typescript
// 插件代码中的调用
const result = await runPythonScript('remove-empty-row', params)

// runPythonScript 函数中的实现
export async function runPythonScript(
  script: string,
  input: any,
  options?: any,
): Promise<any> {
  // 转换输入格式
  const runPyInput: RunPyInput = {
    file: input.fileData ? base64ToBuffer(input.fileData) : undefined,
    fileName: input.fileName || "file.xlsx",
    params: input,
  };

  // 执行Python脚本
  const result = await runPy(script, runPyInput, options);  // 这里直接使用了 script 参数
  // ...
}
```

## 修复方案

### 方案选择
**修改 `runPythonScript` 函数**：这是最优方案，因为：
- 只需修改一个文件，影响范围最小
- 保持插件代码的简洁性
- 更灵活地处理插件脚本的加载

### 具体修改
1. **修改 `runPythonScript` 函数**：
   - 更改函数逻辑，使其能够根据插件名称加载对应的 Python 脚本
   - 添加脚本加载机制，从插件目录中读取对应的 worker.py 文件
   - 保持函数的返回值格式不变，确保向后兼容

2. **增强错误处理**：
   - 提供更详细的错误信息，包括插件名称和脚本加载状态
   - 确保即使在脚本加载失败的情况下也能返回有效的错误对象

### 修复后的预期效果
- 所有插件的 Python 脚本都能正常执行
- 不再出现 "NameError: name 'remove' is not defined" 的错误
- 保持与现有插件代码的兼容性
- 提供更详细的错误信息，便于调试

## 实施步骤
1. 打开 `packages/renderer/src/utils/py.ts` 文件
2. 修改 `runPythonScript` 函数，实现插件脚本的加载逻辑
3. 保存修改并测试修复效果
4. 验证所有插件都能正常工作