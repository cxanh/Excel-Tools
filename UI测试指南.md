# Excel 工具箱 UI 测试指南

## 🎯 测试目标

验证新设计的浅色主题 UI 是否正常工作，包括：
- 前后端通信是否正常
- 文件加载、保存功能是否正常
- 内容处理功能是否正常
- 进度显示是否正常
- 日志记录是否正常

## 📋 测试前准备

### 1. 应用已启动
应用已通过 `npm run dev` 启动，Electron 窗口应该已经打开。

### 2. 后端连接状态
查看左侧边栏底部的连接状态：
- ✅ 应该显示 "后端已连接"（绿色圆点）
- ❌ 如果显示 "后端未连接"，请检查控制台错误

### 3. 测试文件路径
使用以下测试文件（绝对路径）：
```
C:\Users\12607\Desktop\excel工具箱—kiro版\python-backend\tests\test_files\test_load.xlsx
```

## 🧪 测试步骤

### 测试 1: 文件管理 - 加载文件

1. **点击左侧 "📁 文件管理" 菜单**
2. **在文件路径输入框中输入**：
   ```
   C:\Users\12607\Desktop\excel工具箱—kiro版\python-backend\tests\test_files\test_load.xlsx
   ```
3. **点击 "📂 加载文件" 按钮**
4. **预期结果**：
   - 按钮显示 "加载中..."
   - 几秒后显示文件信息卡片
   - 显示文件名、格式、大小、工作表数量
   - 显示工作表列表（每个工作表的行数和列数）
   - 操作日志中显示 "✓ 成功 文件加载成功"

### 测试 2: 文件管理 - 保存文件

1. **确保文件已加载（完成测试 1）**
2. **点击 "💾 保存文件" 按钮**
3. **预期结果**：
   - 按钮显示 "加载中..."
   - 几秒后操作完成
   - 操作日志中显示 "✓ 成功 文件保存成功"
   - 文件信息卡片仍然显示

### 测试 3: 文件管理 - 关闭文件

1. **确保文件已加载（完成测试 1）**
2. **点击 "❌ 关闭文件" 按钮**
3. **预期结果**：
   - 文件信息卡片消失
   - 操作日志中显示 "✓ 成功 文件已关闭"

### 测试 4: 内容处理 - 删除空白行

1. **重新加载文件（重复测试 1）**
2. **点击左侧 "✏️ 内容处理" 菜单**
3. **点击 "🗑️ 删除空白行" 卡片中的 "执行操作" 按钮**
4. **预期结果**：
   - 出现进度覆盖层，显示进度条
   - 进度条从 0% 增长到 100%
   - 显示进度消息（如 "已处理 1/2 个工作表"）
   - 完成后进度层消失
   - 操作日志中显示 "✓ 成功 处理完成: X/X 个工作表成功"

### 测试 5: 内容处理 - 清除空白单元格

1. **确保文件已加载**
2. **在 "内容处理" 视图中**
3. **点击 "🧹 清除空白单元格" 卡片中的 "执行操作" 按钮**
4. **预期结果**：
   - 显示进度条
   - 完成后操作日志显示成功消息

### 测试 6: 内容处理 - 删除公式

1. **确保文件已加载**
2. **点击 "🔢 删除公式" 卡片中的 "执行操作" 按钮**
3. **预期结果**：
   - 显示进度条
   - 完成后操作日志显示成功消息

### 测试 7: 内容处理 - 删除重复行

1. **确保文件已加载**
2. **点击 "🔄 删除重复行" 卡片中的 "执行操作" 按钮**
3. **预期结果**：
   - 显示进度条
   - 完成后操作日志显示成功消息

### 测试 8: 内容处理 - 替换内容

1. **确保文件已加载**
2. **在 "🔍 替换内容" 卡片中**：
   - 在 "查找内容" 输入框输入：`测试`
   - 在 "替换为" 输入框输入：`TEST`
   - 勾选 "区分大小写"
3. **点击 "执行替换" 按钮**
4. **预期结果**：
   - 显示进度条
   - 完成后操作日志显示成功消息

### 测试 9: 操作日志

1. **点击左侧 "📋 操作日志" 菜单**
2. **预期结果**：
   - 显示所有之前操作的日志
   - 每条日志包含：时间、状态（成功/错误/信息）、消息
   - 成功消息显示绿色标签
   - 错误消息显示红色标签
   - 信息消息显示蓝色标签
3. **点击 "清空日志" 按钮**
4. **预期结果**：
   - 所有日志被清除
   - 显示 "暂无操作日志"

### 测试 10: 错误处理 - 文件不存在

1. **回到 "📁 文件管理" 视图**
2. **在文件路径输入框中输入不存在的路径**：
   ```
   C:\不存在的文件.xlsx
   ```
3. **点击 "📂 加载文件" 按钮**
4. **预期结果**：
   - 操作日志显示 "✗ 错误 文件不存在"
   - 不显示文件信息卡片

### 测试 11: 错误处理 - 未加载文件

1. **确保没有加载文件（如果有，先关闭）**
2. **点击 "✏️ 内容处理" 菜单**
3. **预期结果**：
   - 显示空状态提示："请先在'文件管理'中加载一个 Excel 文件"
   - 显示文件夹图标 📂
4. **尝试点击任何操作按钮**
5. **预期结果**：
   - 操作日志显示 "✗ 错误 没有加载的文件，请先加载文件"

## ✅ 测试检查清单

完成以下检查项：

- [ ] 后端连接状态正确显示
- [ ] 文件加载功能正常
- [ ] 文件信息正确显示（文件名、格式、大小、工作表）
- [ ] 文件保存功能正常
- [ ] 文件关闭功能正常
- [ ] 删除空白行功能正常
- [ ] 清除空白单元格功能正常
- [ ] 删除公式功能正常
- [ ] 删除重复行功能正常
- [ ] 替换内容功能正常
- [ ] 进度条正确显示和更新
- [ ] 操作日志正确记录
- [ ] 日志状态颜色正确（成功=绿色，错误=红色，信息=蓝色）
- [ ] 清空日志功能正常
- [ ] 文件不存在错误处理正常
- [ ] 未加载文件错误处理正常
- [ ] UI 响应流畅，无卡顿
- [ ] 浅色主题视觉效果良好

## 🎨 UI 设计验证

### 颜色主题
- 主色调：紫色渐变 (#667eea → #764ba2)
- 背景色：浅灰色 (#f5f7fa)
- 卡片背景：白色
- 成功色：绿色 (#10b981)
- 错误色：红色 (#ef4444)
- 信息色：蓝色 (#3b82f6)

### 交互效果
- 按钮悬停时有阴影效果
- 卡片悬停时有上浮效果
- 输入框聚焦时有蓝色边框
- 过渡动画流畅（0.2s）

### 布局
- 侧边栏宽度：260px
- 卡片圆角：12-16px
- 间距统一：12-30px
- 响应式网格布局

## 📝 测试报告

测试完成后，请记录：

1. **通过的测试**：列出所有通过的测试编号
2. **失败的测试**：列出失败的测试编号和错误信息
3. **UI 问题**：记录任何视觉或交互问题
4. **性能问题**：记录任何卡顿或延迟
5. **改进建议**：提出任何改进建议

---

**测试时间**：_____________

**测试人员**：_____________

**测试结果**：✅ 通过 / ❌ 失败

**备注**：
