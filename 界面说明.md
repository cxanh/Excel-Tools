# Excel 工具箱 - 界面说明

## 🎨 整体布局

```
┌─────────────────────────────────────────────────────────────┐
│  Excel 工具箱                                                │
│  轻松处理 Excel 文件                                          │
├─────────────────────────────────────────────────────────────┤
│                    │                                         │
│  📁 文件管理        │                                         │
│  ✏️ 内容处理        │         主内容区域                       │
│  📋 操作日志        │      （根据左侧菜单切换）                 │
│                    │                                         │
│                    │                                         │
│                    │                                         │
│                    │                                         │
├─────────────────────────────────────────────────────────────┤
│  🟢 后端已连接      │                                         │
└─────────────────────────────────────────────────────────────┘
```

## 📁 文件管理视图

### 布局结构

```
┌─────────────────────────────────────────────────────────────┐
│  📁 文件管理                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ [输入文件路径...] [📂 加载文件] [❌ 关闭文件]            │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 📄 已加载文件                                           │ │
│  │                                                         │ │
│  │ 文件名: test_load.xlsx                                  │ │
│  │ 格式: XLSX                                              │ │
│  │ 大小: 12.5 KB                                           │ │
│  │ 工作表: 2 个                                            │ │
│  │                                                         │ │
│  │ 工作表列表                                              │ │
│  │ ┌─────────────────────────────────────────────────┐   │ │
│  │ │ Sheet1        100 行 × 10 列        ✓ 可见      │   │ │
│  │ └─────────────────────────────────────────────────┘   │ │
│  │ ┌─────────────────────────────────────────────────┐   │ │
│  │ │ Sheet2         50 行 × 5 列         ✓ 可见      │   │ │
│  │ └─────────────────────────────────────────────────┘   │ │
│  │                                                         │ │
│  │ [💾 保存文件]                                           │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 功能说明

1. **文件路径输入框**
   - 输入要加载的 Excel 文件完整路径
   - 支持 .xlsx, .xlsm, .xls 格式
   - 示例：`C:\Users\...\test.xlsx`

2. **加载文件按钮**
   - 点击加载文件
   - 加载中显示 "加载中..."
   - 成功后显示文件信息卡片

3. **关闭文件按钮**
   - 关闭当前加载的文件
   - 清除文件信息卡片
   - 未加载文件时禁用

4. **文件信息卡片**
   - 显示文件基本信息（文件名、格式、大小、工作表数量）
   - 显示所有工作表列表（名称、行数、列数、可见性）
   - 提供保存文件按钮

5. **保存文件按钮**
   - 保存当前文件的所有修改
   - 自动创建备份（保留最近 5 个）
   - 显示保存进度

## ✏️ 内容处理视图

### 布局结构（有文件加载时）

```
┌─────────────────────────────────────────────────────────────┐
│  ✏️ 内容处理                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────────────┐  ┌──────────────────────┐        │
│  │ 🗑️ 删除空白行         │  │ 🧹 清除空白单元格     │        │
│  │                      │  │                      │        │
│  │ 删除工作表中所有单元  │  │ 清除空白单元格内容，  │        │
│  │ 格均为空的行          │  │ 但保留工作表结构      │        │
│  │                      │  │                      │        │
│  │        [执行操作]     │  │        [执行操作]     │        │
│  └──────────────────────┘  └──────────────────────┘        │
│                                                              │
│  ┌──────────────────────┐  ┌──────────────────────┐        │
│  │ 🔢 删除公式           │  │ 🔄 删除重复行         │        │
│  │                      │  │                      │        │
│  │ 将公式替换为计算结果  │  │ 删除完全重复的数据行， │        │
│  │ 值，保持格式不变      │  │ 保留第一次出现的行    │        │
│  │                      │  │                      │        │
│  │        [执行操作]     │  │        [执行操作]     │        │
│  └──────────────────────┘  └──────────────────────┘        │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 🔍 替换内容                                             │ │
│  │                                                         │ │
│  │ 按规则查找并替换单元格内容                               │ │
│  │                                                         │ │
│  │ [查找内容...........] [替换为............]              │ │
│  │                                                         │ │
│  │ ☑ 区分大小写    ☑ 使用正则表达式    [执行替换]          │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 布局结构（无文件加载时）

```
┌─────────────────────────────────────────────────────────────┐
│  ✏️ 内容处理                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│                                                              │
│                         📂                                   │
│                                                              │
│              请先在"文件管理"中加载一个 Excel 文件             │
│                                                              │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 功能说明

1. **删除空白行**
   - 识别所有单元格均为空的行
   - 删除这些行并保持其他行不变
   - 处理所有工作表

2. **清除空白单元格**
   - 清除空白单元格的内容
   - 保留工作表结构（行列不变）
   - 处理所有工作表

3. **删除公式**
   - 识别所有包含公式的单元格
   - 将公式替换为计算结果值
   - 保持单元格格式不变
   - 处理所有工作表

4. **删除重复行**
   - 识别完全重复的数据行
   - 删除重复行，保留第一次出现的行
   - 处理所有工作表

5. **替换内容**
   - 查找内容：输入要查找的文本
   - 替换为：输入替换后的文本
   - 区分大小写：勾选后区分大小写
   - 使用正则表达式：勾选后支持正则表达式匹配
   - 处理所有工作表

## 📋 操作日志视图

### 布局结构

```
┌─────────────────────────────────────────────────────────────┐
│  📋 操作日志                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  共 15 条消息                                [清空日志]       │
│  ─────────────────────────────────────────────────────────  │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 14:23:45  ✓ 成功  文件加载成功                          │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 14:24:12  ✓ 成功  处理完成: 2/2 个工作表成功            │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 14:24:35  ✓ 成功  文件保存成功                          │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 14:25:01  ✗ 错误  文件不存在                            │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 14:25:15  ℹ 信息  正在加载文件: test.xlsx               │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 功能说明

1. **日志统计**
   - 显示当前日志总数
   - 最多保留 100 条日志

2. **清空日志按钮**
   - 清除所有日志记录
   - 显示 "暂无操作日志"

3. **日志条目**
   - 时间戳：操作发生的时间（HH:MM:SS）
   - 状态标签：
     - ✓ 成功（绿色）- 操作成功完成
     - ✗ 错误（红色）- 操作失败
     - ℹ 信息（蓝色）- 一般信息
   - 消息内容：操作的详细描述

4. **日志排序**
   - 最新的日志显示在最上方
   - 自动滚动到最新日志

## 🎯 进度覆盖层

### 布局结构

```
┌─────────────────────────────────────────────────────────────┐
│                                                              │
│                                                              │
│                  ┌──────────────────────┐                   │
│                  │                      │                   │
│                  │    处理中...         │                   │
│                  │                      │                   │
│                  │  ████████░░░░  65%   │                   │
│                  │                      │                   │
│                  │  已处理 2/3 个工作表  │                   │
│                  │                      │                   │
│                  └──────────────────────┘                   │
│                                                              │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 功能说明

1. **进度卡片**
   - 显示 "处理中..." 标题
   - 显示进度条（0-100%）
   - 显示进度百分比数字
   - 显示当前处理状态消息

2. **进度条**
   - 紫色渐变填充
   - 实时更新进度
   - 平滑过渡动画

3. **进度消息**
   - 显示当前处理的工作表
   - 显示处理进度（如 "已处理 2/3 个工作表"）
   - 实时更新

4. **覆盖层**
   - 半透明白色背景
   - 模糊效果（backdrop-filter）
   - 阻止用户操作，防止重复提交

## 🎨 颜色主题

### 主色调
- **紫色渐变**：#667eea → #764ba2
- 用于：主按钮、进度条、活动菜单项

### 背景色
- **浅灰色**：#f5f7fa
- 用于：主内容区背景

### 卡片背景
- **白色**：#ffffff
- 用于：所有卡片和面板

### 状态颜色
- **成功绿色**：#10b981
- **错误红色**：#ef4444
- **信息蓝色**：#3b82f6
- **中性灰色**：#8b95a1

### 文字颜色
- **标题黑色**：#1a202c
- **正文灰色**：#5a6c7d
- **次要灰色**：#8b95a1

### 边框颜色
- **浅灰色**：#e1e4e8

## 🖱️ 交互效果

### 按钮
- **悬停**：向上移动 1px，显示阴影
- **点击**：轻微缩放效果
- **禁用**：50% 透明度，禁止点击

### 卡片
- **悬停**：向上移动 2px，增强阴影
- **过渡**：0.2s 平滑过渡

### 输入框
- **聚焦**：蓝色边框，外发光效果
- **过渡**：0.2s 平滑过渡

### 菜单项
- **悬停**：浅灰色背景，紫色文字
- **活动**：紫色渐变背景，紫色文字，加粗

### 滚动条
- **轨道**：浅灰色 #f1f1f1
- **滑块**：中灰色 #cbd5e0
- **悬停**：深灰色 #a0aec0

## 📐 尺寸规范

### 侧边栏
- **宽度**：260px
- **Logo 区域高度**：约 100px
- **菜单项高度**：约 50px
- **底部状态栏高度**：约 60px

### 卡片
- **圆角**：12-16px
- **内边距**：24-30px
- **外边距**：20px

### 按钮
- **高度**：40-44px
- **内边距**：12px 24px
- **圆角**：10px

### 输入框
- **高度**：40-44px
- **内边距**：12px 16px
- **圆角**：8-10px

### 间距
- **小间距**：8-12px
- **中间距**：16-20px
- **大间距**：24-30px

## 🔤 字体规范

### 字体家族
- **主字体**：'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif
- **等宽字体**：'Courier New', monospace（用于时间戳）

### 字体大小
- **大标题**：28px（视图标题）
- **中标题**：20px（Logo）
- **小标题**：18px（卡片标题）
- **正文**：14-16px
- **小字**：12-13px（标签、提示）

### 字体粗细
- **标题**：600（Semi-bold）
- **正文**：400（Regular）
- **强调**：500（Medium）

---

**设计理念**：简洁、现代、易用、舒适

**视觉风格**：浅色主题、柔和渐变、流畅动画、清晰层次
