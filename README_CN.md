# Excel å·¥å…·ç®± - æ¡Œé¢åº”ç”¨

> åŠŸèƒ½å®Œå¤‡çš„ Excel æ‰¹é‡å¤„ç†å·¥å…·ï¼Œé‡‡ç”¨ Electron + Vue 3 + Python æ¶æ„

## ğŸ“– é¡¹ç›®ç®€ä»‹

Excel å·¥å…·ç®±æ˜¯ä¸€æ¬¾æ¡Œé¢ç«¯ Excel æ‰¹é‡å¤„ç†å·¥å…·ï¼Œæä¾›æ–‡ä»¶ç®¡ç†ã€å†…å®¹å¤„ç†ã€å›¾åƒå¤„ç†ã€å·¥ä½œè¡¨ç®¡ç†ã€æ–‡ä»¶åˆå¹¶æ‹†åˆ†ã€æ ¼å¼è½¬æ¢ç­‰åŠŸèƒ½ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ¨ **æµ…è‰²ä¸»é¢˜è®¾è®¡** - ç´«è‰²æ¸å˜ä¸»è‰²è°ƒï¼Œè½»æ¾èˆ’é€‚çš„è§†è§‰ä½“éªŒ
- âš¡ **é«˜æ€§èƒ½æ¶æ„** - Python é•¿è¿æ¥æ¨¡å¼ï¼Œé¿å…é¢‘ç¹å¯åŠ¨è¿›ç¨‹
- ğŸ“Š **å®æ—¶è¿›åº¦æ˜¾ç¤º** - é•¿æ—¶é—´æ“ä½œå®æ—¶æ›´æ–°è¿›åº¦æ¡
- ğŸ’¾ **è‡ªåŠ¨å¤‡ä»½æœºåˆ¶** - ä¿å­˜å‰è‡ªåŠ¨å¤‡ä»½ï¼Œä¿ç•™æœ€è¿‘ 5 ä¸ªç‰ˆæœ¬
- ğŸ”’ **æ–‡ä»¶å ç”¨æ£€æµ‹** - æ™ºèƒ½æ£€æµ‹æ–‡ä»¶æ˜¯å¦è¢«å ç”¨ï¼Œå‹å¥½æç¤º
- ğŸ“ **æ“ä½œæ—¥å¿—è®°å½•** - æ‰€æœ‰æ“ä½œè‡ªåŠ¨è®°å½•ï¼Œæ–¹ä¾¿è¿½æº¯

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Node.js**: 16.0.0+
- **Python**: 3.9.0+
- **æ“ä½œç³»ç»Ÿ**: Windows 10+, macOS 11+, Ubuntu 20.04+

### å®‰è£…ä¾èµ–

```bash
# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# å®‰è£… Python ä¾èµ–
pip install -r python-backend/requirements.txt
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

åº”ç”¨å°†è‡ªåŠ¨æ‰“å¼€ Electron çª—å£ï¼ŒPython åç«¯ä¼šè‡ªåŠ¨å¯åŠ¨å¹¶è¿æ¥ã€‚

## ğŸ“š åŠŸèƒ½åˆ—è¡¨

### âœ… å·²å®ç°åŠŸèƒ½

#### 1. æ–‡ä»¶ç®¡ç†
- âœ… åŠ è½½ Excel æ–‡ä»¶ï¼ˆ.xlsx, .xlsm, .xlsï¼‰
- âœ… æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ï¼ˆæ–‡ä»¶åã€æ ¼å¼ã€å¤§å°ã€å·¥ä½œè¡¨åˆ—è¡¨ï¼‰
- âœ… ä¿å­˜æ–‡ä»¶ï¼ˆè‡ªåŠ¨å¤‡ä»½ï¼‰
- âœ… å…³é—­æ–‡ä»¶
- âœ… æ–‡ä»¶å ç”¨æ£€æµ‹
- âœ… å¤‡ä»½ç®¡ç†ï¼ˆä¿ç•™æœ€è¿‘ 5 ä¸ªå¤‡ä»½ï¼‰

#### 2. å†…å®¹å¤„ç†
- âœ… åˆ é™¤ç©ºç™½è¡Œ - åˆ é™¤æ‰€æœ‰å•å…ƒæ ¼å‡ä¸ºç©ºçš„è¡Œ
- âœ… æ¸…é™¤ç©ºç™½å•å…ƒæ ¼ - æ¸…é™¤ç©ºç™½å•å…ƒæ ¼å†…å®¹ä½†ä¿ç•™ç»“æ„
- âœ… åˆ é™¤å…¬å¼ - å°†å…¬å¼æ›¿æ¢ä¸ºè®¡ç®—å€¼ï¼Œä¿æŒæ ¼å¼ä¸å˜
- âœ… åˆ é™¤é‡å¤è¡Œ - åˆ é™¤å®Œå…¨é‡å¤çš„æ•°æ®è¡Œ
- âœ… æ›¿æ¢å†…å®¹ - æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€åŒºåˆ†å¤§å°å†™ã€å…¨è¯åŒ¹é…

#### 3. ç”¨æˆ·ç•Œé¢
- âœ… ä¾§è¾¹æ å¯¼èˆªï¼ˆæ–‡ä»¶ç®¡ç†ã€å†…å®¹å¤„ç†ã€æ“ä½œæ—¥å¿—ï¼‰
- âœ… æ–‡ä»¶ç®¡ç†ç•Œé¢
- âœ… å†…å®¹å¤„ç†ç•Œé¢ï¼ˆ5 ä¸ªæ“ä½œå¡ç‰‡ï¼‰
- âœ… æ“ä½œæ—¥å¿—ç•Œé¢
- âœ… è¿›åº¦æ¡è¦†ç›–å±‚
- âœ… è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨

### ğŸš§ å¼€å‘ä¸­åŠŸèƒ½

#### 4. å›¾åƒå¤„ç†
- â³ æå–å›¾ç‰‡ - ä» Excel ä¸­æå–æ‰€æœ‰å›¾ç‰‡
- â³ æ›¿æ¢å›¾ç‰‡ - æ›¿æ¢å·¥ä½œè¡¨ä¸­çš„å›¾ç‰‡
- â³ æ·»åŠ æ°´å° - ä¸ºå›¾ç‰‡æ·»åŠ æ–‡å­—æˆ–å›¾ç‰‡æ°´å°

#### 5. å·¥ä½œè¡¨ç®¡ç†
- â³ æ’å…¥å·¥ä½œè¡¨ - åœ¨æŒ‡å®šä½ç½®æ’å…¥æ–°å·¥ä½œè¡¨
- â³ åˆ é™¤å·¥ä½œè¡¨ - åˆ é™¤æŒ‡å®šçš„å·¥ä½œè¡¨
- â³ é‡å‘½åå·¥ä½œè¡¨ - ä¿®æ”¹å·¥ä½œè¡¨åç§°

#### 6. æ–‡ä»¶åˆå¹¶ä¸æ‹†åˆ†
- â³ Excel æ–‡ä»¶åˆå¹¶ - åˆå¹¶å¤šä¸ª Excel æ–‡ä»¶
- â³ CSV æ–‡ä»¶åˆå¹¶ - åˆå¹¶å¤šä¸ª CSV æ–‡ä»¶
- â³ Excel æ–‡ä»¶æ‹†åˆ† - æŒ‰è¡Œæ•°æ‹†åˆ†å¤§æ–‡ä»¶
- â³ CSV æ–‡ä»¶æ‹†åˆ† - æŒ‰è¡Œæ•°æ‹†åˆ† CSV æ–‡ä»¶

#### 7. æ ¼å¼è½¬æ¢
- â³ Excel è½¬ PDF - æ”¯æŒ Windows COM ç»„ä»¶å’Œ LibreOffice
- â³ Excel è½¬ CSV - æ”¯æŒå¤šç§ç¼–ç æ ¼å¼

#### 8. æ–‡ä»¶å±æ€§ç®¡ç†
- â³ æ¸…ç†å…ƒæ•°æ® - åˆ é™¤ä½œè€…ã€ä¿®æ”¹è€…ç­‰ä¿¡æ¯
- â³ å¯†ç ä¿æŠ¤ - è®¾ç½®å·¥ä½œç°¿å’Œå·¥ä½œè¡¨å¯†ç 
- â³ æ–‡ä»¶ä¼˜åŒ– - å‹ç¼©å›¾ç‰‡ã€ç§»é™¤æœªä½¿ç”¨çš„æ ·å¼

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
excel-toolkit-desktop/
â”œâ”€â”€ electron/                 # Electron ä¸»è¿›ç¨‹å’Œé¢„åŠ è½½è„šæœ¬
â”‚   â”œâ”€â”€ main.ts              # ä¸»è¿›ç¨‹ï¼ˆPython æ¡¥æ¥ï¼‰
â”‚   â””â”€â”€ preload.ts           # é¢„åŠ è½½è„šæœ¬ï¼ˆå®‰å…¨ APIï¼‰
â”œâ”€â”€ src/                     # Vue 3 å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ App.vue              # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â””â”€â”€ main.ts              # å‰ç«¯å…¥å£
â”œâ”€â”€ python-backend/          # Python åç«¯
â”‚   â”œâ”€â”€ main.py              # åç«¯å…¥å£ï¼ˆé•¿è¿æ¥æ¨¡å¼ï¼‰
â”‚   â”œâ”€â”€ cli_router.py        # å‘½ä»¤è·¯ç”±å™¨
â”‚   â”œâ”€â”€ engine/              # åŠŸèƒ½å¼•æ“
â”‚   â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒæ¨¡å—ï¼ˆåŠ è½½ã€ä¿å­˜ï¼‰
â”‚   â”‚   â”œâ”€â”€ content/         # å†…å®¹å¤„ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ image/           # å›¾åƒå¤„ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ sheet/           # å·¥ä½œè¡¨ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ merge_split/     # åˆå¹¶æ‹†åˆ†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ convert/         # æ ¼å¼è½¬æ¢æ¨¡å—
â”‚   â”‚   â””â”€â”€ property/        # å±æ€§ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ tests/               # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ .kiro/                   # Kiro é…ç½®å’Œè§„èŒƒ
â”‚   â””â”€â”€ specs/               # é¡¹ç›®è§„èŒƒæ–‡æ¡£
â”œâ”€â”€ package.json             # Node.js ä¾èµ–
â”œâ”€â”€ requirements.txt         # Python ä¾èµ–
â””â”€â”€ vite.config.ts           # Vite é…ç½®

```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
cd python-backend
pytest tests/ -v
```

### è¿è¡Œç‰¹å®šæµ‹è¯•

```bash
# é€šä¿¡æœºåˆ¶æµ‹è¯•
pytest tests/test_cli_router.py -v
pytest tests/test_integration.py -v

# æ–‡ä»¶æ“ä½œæµ‹è¯•
pytest tests/test_file_loader.py -v
pytest tests/test_file_saver.py -v

# å†…å®¹å¤„ç†æµ‹è¯•
pytest tests/test_content_processor.py -v
```

### æµ‹è¯•è¦†ç›–ç‡

å½“å‰æµ‹è¯•çŠ¶æ€ï¼š**54/54 é€šè¿‡** âœ…

- é€šä¿¡æœºåˆ¶æµ‹è¯•ï¼š12/12 âœ…
- æ–‡ä»¶åŠ è½½æµ‹è¯•ï¼š15/15 âœ…
- æ–‡ä»¶ä¿å­˜æµ‹è¯•ï¼š15/15 âœ…
- å†…å®¹å¤„ç†æµ‹è¯•ï¼š12/12 âœ…

## ğŸ“¦ æ‰“åŒ…éƒ¨ç½²

### æ‰“åŒ… Python åç«¯

```bash
# Windows
npm run build:python:win

# macOS
npm run build:python:mac

# Linux
npm run build:python:linux
```

### æ‰“åŒ…å®Œæ•´åº”ç”¨

```bash
# Windows
npm run build:win

# macOS
npm run build:mac

# Linux
npm run build:linux
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **Electron** 28.0.0 - æ¡Œé¢åº”ç”¨æ¡†æ¶
- **Vue 3** 3.4.0 - UI æ¡†æ¶
- **TypeScript** 5.3.0 - ç±»å‹å®‰å…¨
- **Vite** 5.0.0 - æ„å»ºå·¥å…·
- **Pinia** 2.1.0 - çŠ¶æ€ç®¡ç†

### åç«¯
- **Python** 3.10+ - åç«¯è¯­è¨€
- **openpyxl** 3.1.5 - Excel 2007+ è¯»å†™
- **pandas** 2.2.3 - æ•°æ®å¤„ç†
- **xlrd** 2.0.1 - Excel 97-2003 è¯»å–
- **Pillow** - å›¾åƒå¤„ç†ï¼ˆå¾…å®‰è£…ï¼‰

### æµ‹è¯•
- **pytest** - Python æµ‹è¯•æ¡†æ¶
- **hypothesis** - å±æ€§æµ‹è¯•æ¡†æ¶

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### 1. é•¿è¿æ¥æ¨¡å¼
Python è¿›ç¨‹åœ¨åº”ç”¨å¯åŠ¨æ—¶å¯åŠ¨ï¼Œä¿æŒè¿è¡Œç›´åˆ°åº”ç”¨å…³é—­ï¼Œé¿å…é¢‘ç¹å¯åŠ¨/å…³é—­è¿›ç¨‹ï¼Œå¤§å¹…æå‡æ€§èƒ½ã€‚

```python
# Python ç«¯ï¼šæŒç»­ç›‘å¬ stdin
while True:
    line = sys.stdin.readline()
    if not line:
        break
    command = json.loads(line.strip())
    result = router.route(command)
    print(json.dumps(result), flush=True)
```

### 2. æ—¥å¿—åˆ†ç¦»
æ‰€æœ‰æ—¥å¿—è¾“å‡ºåˆ° stderrï¼ŒJSON æ•°æ®è¾“å‡ºåˆ° stdoutï¼Œé¿å…æ—¥å¿—å¹²æ‰°æ•°æ®ä¼ è¾“ã€‚

```python
# æ—¥å¿—è¾“å‡ºåˆ° stderr
sys.stderr.write(f"[LOG] {message}\n")

# æ•°æ®è¾“å‡ºåˆ° stdout
print(json.dumps(result), flush=True)
```

### 3. å®æ—¶è¿›åº¦æ›´æ–°
Python åç«¯å®æ—¶å‘é€è¿›åº¦ JSONï¼ŒElectron ç›‘å¬ stdout æµï¼Œå®æ—¶æ›´æ–° UIï¼Œé¿å…é•¿æ—¶é—´æ“ä½œå¯¼è‡´ç•Œé¢å‡æ­»ã€‚

```python
# Python ç«¯ï¼šå‘é€è¿›åº¦
def send_progress(progress, message):
    progress_data = {
        "type": "progress",
        "progress": progress,
        "message": message
    }
    print(json.dumps(progress_data), flush=True)
```

```typescript
// Electron ç«¯ï¼šç›‘å¬è¿›åº¦
pythonProcess.stdout.on('data', (data) => {
  const message = JSON.parse(data.toString());
  if (message.type === 'progress') {
    updateProgress(message.progress, message.message);
  }
});
```

### 4. è‡ªåŠ¨å¤‡ä»½æœºåˆ¶
ä¿å­˜å‰è‡ªåŠ¨åˆ›å»ºå¤‡ä»½ï¼Œä¿ç•™æœ€è¿‘ 5 ä¸ªå¤‡ä»½ï¼Œä¿å­˜å¤±è´¥è‡ªåŠ¨æ¢å¤ã€‚

```python
# å¤‡ä»½å‘½åï¼šfilename_YYYYMMDD_HHMMSS_microseconds.backup.ext
# å¤‡ä»½ç›®å½•ï¼š.filename_backups/ï¼ˆéšè—ï¼‰
```

### 5. æ–‡ä»¶å ç”¨æ£€æµ‹
æ™ºèƒ½æ£€æµ‹æ–‡ä»¶æ˜¯å¦è¢«å…¶ä»–ç¨‹åºå ç”¨ï¼Œè¿”å›å‹å¥½çš„é”™è¯¯æç¤ºã€‚

```python
try:
    wb = openpyxl.load_workbook(file_path)
except PermissionError:
    return {
        "error_code": "FILE_IN_USE",
        "message": "æ–‡ä»¶æ­£åœ¨è¢«å…¶ä»–ç¨‹åºä½¿ç”¨ï¼Œè¯·å…ˆå…³é—­ Excel åé‡è¯•"
    }
```

## ğŸ“– æ–‡æ¡£

- **å¿«é€Ÿå¼€å§‹**ï¼š`å¿«é€Ÿå¼€å§‹.md` - 5 åˆ†é’Ÿä¸Šæ‰‹æŒ‡å—
- **UI æµ‹è¯•æŒ‡å—**ï¼š`UIæµ‹è¯•æŒ‡å—.md` - å®Œæ•´çš„æµ‹è¯•æ­¥éª¤å’Œæ£€æŸ¥æ¸…å•
- **å½“å‰è¿›åº¦æ€»ç»“**ï¼š`å½“å‰è¿›åº¦æ€»ç»“.md` - é¡¹ç›®è¿›åº¦å’ŒæŠ€æœ¯äº®ç‚¹
- **ä»»åŠ¡åˆ—è¡¨**ï¼š`.kiro/specs/excel-toolkit-desktop/tasks.md` - å®Œæ•´çš„å¼€å‘ä»»åŠ¡
- **è®¾è®¡æ–‡æ¡£**ï¼š`.kiro/specs/excel-toolkit-desktop/design.md` - ç³»ç»Ÿæ¶æ„è®¾è®¡
- **éœ€æ±‚æ–‡æ¡£**ï¼š`.kiro/specs/excel-toolkit-desktop/requirements.md` - åŠŸèƒ½éœ€æ±‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**å¼€å‘å›¢é˜Ÿ**ï¼šExcel Toolkit Team  
**æœ€åæ›´æ–°**ï¼š2026-01-16  
**ç‰ˆæœ¬**ï¼š1.0.0-alpha
