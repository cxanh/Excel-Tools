import{_ as R,r as w,a as i,c as k,o as g,d as u,b as t,f as $,e as _,w as o,g as r,t as j,k as A}from"./index-B5FopeIw.js";const O={class:"plugin-template"},J={class:"top-bar"},D={class:"plugin-title"},q={class:"action-buttons"},G={class:"file-table-container"},H={key:0,class:"drop-area"},K={class:"bottom-bar"},L={key:0,class:"progress-container"},Q={class:"bottom-buttons"},U={__name:"PluginTemplate",props:{pluginTitle:{type:String,default:"插件功能"},infoMessage:{type:String,default:""},currentStep:{type:Number,default:0}},emits:["add-file","import-folder","more-action","next-step","prev-step","remove-file"],setup(c,{expose:s,emit:a}){const n=a,l=w([]),d=w(0);s({files:l});const m=[{title:"序号",dataIndex:"index",key:"index",width:80},{title:"名称",dataIndex:"name",key:"name"},{title:"路径",dataIndex:"path",key:"path",ellipsis:!0},{title:"扩展名",dataIndex:"extension",key:"extension",width:100},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180},{title:"修改时间",dataIndex:"modifyTime",key:"modifyTime",width:180},{title:"操作",dataIndex:"actions",key:"actions",width:120,fixed:"right"}],v=()=>{n("add-file")},B=()=>{n("import-folder")},C=({key:p})=>{n("more-action",p)},N=p=>{l.value=l.value.filter(e=>e.key!==p),n("remove-file",p)},S=()=>{n("next-step")},T=()=>{n("prev-step")};return(p,e)=>{const f=i("a-button"),x=i("a-icon"),h=i("a-menu-item"),F=i("a-menu"),I=i("a-dropdown"),y=i("a-step"),E=i("a-steps"),M=i("a-alert"),P=i("a-table"),V=i("a-progress");return g(),k("div",O,[u("div",J,[t(f,{type:"default",icon:"arrow-left",onClick:e[0]||(e[0]=b=>p.$router.push("/"))},{default:o(()=>[...e[1]||(e[1]=[r(" 返回主面板 ",-1)])]),_:1}),u("h2",D,j(c.pluginTitle),1),u("div",q,[t(f,{type:"primary",icon:"plus",onClick:v},{default:o(()=>[...e[2]||(e[2]=[r(" 添加文件 ",-1)])]),_:1}),t(f,{type:"default",icon:"folder-open",onClick:B},{default:o(()=>[...e[3]||(e[3]=[r(" 从文件夹中导入文件 ",-1)])]),_:1}),t(I,null,{overlay:o(()=>[t(F,{onClick:C},{default:o(()=>[t(h,{key:"paste"},{default:o(()=>[...e[5]||(e[5]=[r("从剪贴板读取",-1)])]),_:1}),t(h,{key:"clear"},{default:o(()=>[...e[6]||(e[6]=[r("清空列表",-1)])]),_:1})]),_:1})]),default:o(()=>[t(f,{type:"default"},{default:o(()=>[e[4]||(e[4]=r(" 更多 ",-1)),t(x,{type:"down"})]),_:1})]),_:1})])]),t(E,{current:c.currentStep,class:"steps"},{default:o(()=>[t(y,{title:"选择待处理文件"}),t(y,{title:"设置处理规则"}),t(y,{title:"设置其它选项"}),t(y,{title:"设置输出目录"}),t(y,{title:"开始处理"})]),_:1},8,["current"]),c.infoMessage?(g(),$(M,{key:0,message:c.infoMessage,type:"info","show-icon":"",class:"info-alert"},null,8,["message"])):_("",!0),u("div",G,[t(P,{columns:m,"data-source":l.value,pagination:!1,bordered:"",size:"small"},{bodyCell:o(({column:b,record:z})=>[b.key==="actions"?(g(),$(f,{key:0,type:"text",size:"small",onClick:W=>N(z.key),style:{color:"#ff4d4f"}},{default:o(()=>[...e[7]||(e[7]=[r(" 删除 ",-1)])]),_:1},8,["onClick"])):_("",!0)]),_:1},8,["data-source"]),l.value.length===0?(g(),k("div",H,[...e[8]||(e[8]=[A('<div class="drop-content" data-v-fd9f56ff><div class="cross-icon" data-v-fd9f56ff><svg width="64" height="64" viewBox="0 0 64 64" fill="none" data-v-fd9f56ff><line x1="16" y1="32" x2="48" y2="32" stroke="#d9d9d9" stroke-width="2" data-v-fd9f56ff></line><line x1="32" y1="16" x2="32" y2="48" stroke="#d9d9d9" stroke-width="2" data-v-fd9f56ff></line></svg></div><p class="drop-text" data-v-fd9f56ff>您可以将待处理内容「拖放」到此处</p><p class="drop-tip" data-v-fd9f56ff> 如果无法拖动，请查看<a href="#" style="color:#165dff;" data-v-fd9f56ff>这里</a>或使用右上方「更多」中的从剪贴板自动读取 </p></div>',1)])])):_("",!0)]),u("div",K,[d.value>0?(g(),k("div",L,[t(V,{percent:d.value,"show-info":!1},null,8,["percent"])])):_("",!0),u("div",Q,[t(f,{type:"default",size:"large",onClick:T,disabled:c.currentStep===0,style:{"margin-right":"16px"}},{default:o(()=>[t(x,{type:"left"}),e[9]||(e[9]=r(" 上一步 ",-1))]),_:1},8,["disabled"]),t(f,{type:"primary",size:"large",onClick:S,disabled:l.value.length===0},{default:o(()=>[e[10]||(e[10]=r(" 下一步 ",-1)),t(x,{type:"right"})]),_:1},8,["disabled"])])])])}}},Y=R(U,[["__scopeId","data-v-fd9f56ff"]]);async function Z(c,s){let a=[],n;if(s instanceof File)return a=["文件已接收","模拟处理完成"],n=await s.arrayBuffer(),{buffer:n,logs:a,success:!0};if(typeof s=="object"&&s.excelFile instanceof File&&s.replaceImage){const l=await s.excelFile.arrayBuffer();return a=["收到Excel文件和替换图片","模拟图片替换完成"],a.push(`替换图片: ${s.imageFileName}`),a.push(`设置参数: ${JSON.stringify(s.settings)}`),n=l,{buffer:n,logs:a,success:!0}}else if(typeof s=="object"&&s.file instanceof File){const l=await s.file.arrayBuffer();return a=["收到Excel文件","模拟内容替换完成"],s.replacementRules&&(a.push(`替换规则数量: ${s.replacementRules.length}`),s.replacementRules.forEach((d,m)=>{a.push(`规则 ${m+1}: 查找"${d.findText}" → 替换为"${d.replaceText||"（删除）"}" (${d.matchMode==="regex"?"正则":"普通"})`)})),s.settings&&a.push(`设置参数: ${JSON.stringify(s.settings)}`),n=l,{buffer:n,logs:a,success:!0}}else{const l=Object.keys(s);return a=["收到多个文件，开始合并..."],l.forEach((m,v)=>{a.push(`  - 处理文件 ${v+1}: ${m}`)}),a.push(`共处理 ${l.length} 个文件`),a.push("文件合并完成"),{buffer:new ArrayBuffer(1024),logs:a,success:!0}}}export{Y as P,Z as r};
