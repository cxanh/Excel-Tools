import{P as W}from"./PluginTemplate-Bk8KtKqf.js";import{r as X}from"./py-lgh_vU0b.js";import{_ as Y,r as w,b as y,c as k,d as r,e as n,g as a,f as p,h as b,w as l,i as u,t as c,F,j as Z,s as ee}from"./index-tMO3H4K7.js";const te={class:"remove-empty-row"},le={style:{display:"none"}},ne={key:0,class:"step-content"},oe={key:1,class:"step-content"},ue={key:2,class:"step-content"},ae={key:0,style:{"margin-top":"12px"}},se={key:0,style:{"margin-left":"12px",color:"#666"}},ie={key:3,class:"step-content"},re={class:"processing-summary"},de={class:"settings-summary"},pe={key:5,style:{margin:"16px 0"}},ve={__name:"index",setup(me){const D=w(null),f=w(0),g=w([]),S=w(!1),R=w(0),d=w([]),U=w(null),t=w({contentToRemove:["emptyRows"],sheetOption:"all",selectedSheets:"",emptyRowDefinition:"all",keepHeaderRow:!0,emptyColumnDefinition:"all",keepHeaderColumn:!0,ignoreHiddenSheets:!0,ignoreFilteredRows:!0,enableDetailedLogs:!0,outputLocation:"same",customOutputDir:"",filenameMode:"append",filenameSuffix:"_处理后",customFilename:""}),$=()=>({all:"处理所有工作表",active:"只处理当前工作表",selected:`指定工作表：${t.value.selectedSheets}`})[t.value.sheetOption]||"处理所有工作表",I=()=>({all:"所有单元格为空",data:"数据列为空（忽略格式列）"})[t.value.emptyRowDefinition]||"所有单元格为空",N=()=>({all:"所有单元格为空",data:"数据行为空（忽略格式行）"})[t.value.emptyColumnDefinition]||"所有单元格为空",E=()=>{const i={emptySheets:"空白工作表",emptyRows:"空白行",emptyColumns:"空白列"};return t.value.contentToRemove.map(e=>i[e]).join(", ")},P=()=>t.value.outputLocation==="same"?"与源文件相同目录":t.value.customOutputDir||"未选择输出目录",A=()=>{d.value.push("选择输出目录功能开发中...")},B=async()=>(await fetch("/plugins/remove-empty-row/worker.py")).text(),j=()=>{var i;(i=U.value)==null||i.click()},V=()=>{d.value.push("从文件夹导入功能开发中...")},z=i=>{switch(i){case"paste":d.value.push("从剪贴板读取功能开发中...");break;case"clear":g.value=[];break}},J=async()=>{f.value===0?(f.value=1,d.value.push("进入设置处理规则步骤...")):f.value===1?(f.value=2,d.value.push("进入设置其他选项步骤...")):f.value===2?(f.value=3,d.value.push("进入设置输出目录步骤...")):f.value===3&&(f.value=4,await L())},h=i=>{g.value=g.value.filter(e=>e.key!==i)},q=i=>{const e=Array.from(i.target.files);e.length>0&&(e.forEach((s,_)=>{const v={key:`${s.name}-${Date.now()}-${_}`,index:g.value.length+_+1,name:s.name,path:s.name,extension:s.name.split(".").pop(),createTime:new Date(s.lastModified).toLocaleString(),modifyTime:new Date(s.lastModified).toLocaleString(),file:s};g.value.push(v)}),i.target.value="",ee(()=>{D.value&&(D.value.files=g.value)}))},L=async()=>{if(g.value.length!==0){S.value=!0,d.value=["开始处理文件..."],R.value=10;try{const i=await B();R.value=30;for(let e=0;e<g.value.length;e++){const s=g.value[e];d.value.push(`正在处理文件：${s.name}`),d.value.push(`设置参数：${JSON.stringify(t.value)}`);const _=await X(i,{type:"single",file:s.file,fileName:s.name,settings:t.value});R.value=30+Math.round((e+1)/g.value.length*50),d.value.push(`${s.name} 处理完成！`),d.value.push(..._.logs);const v=new Blob([_.buffer],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=URL.createObjectURL(v),x=document.createElement("a");x.href=m,x.download=`${s.name.replace(".xlsx","").replace(".xls","")}_处理后.xlsx`,x.click(),URL.revokeObjectURL(m)}d.value.push("所有文件处理完成！"),R.value=100}catch(i){d.value.push(`错误：${i.message}`),console.error("Processing error:",i)}finally{S.value=!1}}};return(i,e)=>{const s=y("a-checkbox"),_=y("a-checkbox-group"),v=y("a-form-item"),m=y("a-radio"),x=y("a-radio-group"),C=y("a-input"),O=y("a-collapse-panel"),H=y("a-collapse"),T=y("a-form"),M=y("a-button"),G=y("a-progress"),K=y("a-list-item"),Q=y("a-list");return r(),k("div",te,[n(W,{"plugin-title":"删除 Excel 空白内容","info-message":"批量删除 Excel 文件中的空白工作表、空白行和空白列，提升数据处理效率","current-step":f.value,onAddFile:j,onImportFolder:V,onMoreAction:z,onNextStep:J,onRemoveFile:h,ref_key:"pluginTemplate",ref:D},null,8,["current-step"]),a("div",le,[a("input",{ref_key:"fileInput",ref:U,type:"file",accept:".xlsx,.xls",multiple:"",onChange:q},null,544)]),f.value===1?(r(),k("div",ne,[e[26]||(e[26]=a("h3",null,"空白内容删除设置",-1)),n(T,{layout:"vertical"},{default:l(()=>[n(v,{label:"处理内容"},{default:l(()=>[n(_,{value:t.value.contentToRemove,"onUpdate:value":e[0]||(e[0]=o=>t.value.contentToRemove=o)},{default:l(()=>[n(s,{value:"emptySheets"},{default:l(()=>[...e[14]||(e[14]=[u("删除空白工作表",-1)])]),_:1}),n(s,{value:"emptyRows"},{default:l(()=>[...e[15]||(e[15]=[u("删除空白行",-1)])]),_:1}),n(s,{value:"emptyColumns"},{default:l(()=>[...e[16]||(e[16]=[u("删除空白列",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(v,{label:"工作表选项"},{default:l(()=>[n(x,{value:t.value.sheetOption,"onUpdate:value":e[1]||(e[1]=o=>t.value.sheetOption=o)},{default:l(()=>[n(m,{value:"all"},{default:l(()=>[...e[17]||(e[17]=[u("处理所有工作表",-1)])]),_:1}),n(m,{value:"active"},{default:l(()=>[...e[18]||(e[18]=[u("只处理当前工作表",-1)])]),_:1}),n(m,{value:"selected"},{default:l(()=>[...e[19]||(e[19]=[u("指定工作表（用逗号分隔）",-1)])]),_:1})]),_:1},8,["value"]),t.value.sheetOption==="selected"?(r(),b(C,{key:0,value:t.value.selectedSheets,"onUpdate:value":e[2]||(e[2]=o=>t.value.selectedSheets=o),placeholder:"请输入工作表名称，用逗号分隔",style:{"margin-top":"12px"}},null,8,["value"])):p("",!0)]),_:1}),t.value.contentToRemove.includes("emptyRows")?(r(),b(H,{key:0},{default:l(()=>[n(O,{key:"rowSettings",header:"空白行设置"},{default:l(()=>[n(v,{label:"空白行定义"},{default:l(()=>[n(x,{value:t.value.emptyRowDefinition,"onUpdate:value":e[3]||(e[3]=o=>t.value.emptyRowDefinition=o)},{default:l(()=>[n(m,{value:"all"},{default:l(()=>[...e[20]||(e[20]=[u("所有单元格为空",-1)])]),_:1}),n(m,{value:"data"},{default:l(()=>[...e[21]||(e[21]=[u("数据列为空（忽略格式列）",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(v,{label:"保留选项"},{default:l(()=>[n(s,{checked:t.value.keepHeaderRow,"onUpdate:checked":e[4]||(e[4]=o=>t.value.keepHeaderRow=o)},{default:l(()=>[...e[22]||(e[22]=[u("保留表头行",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})]),_:1})):p("",!0),t.value.contentToRemove.includes("emptyColumns")?(r(),b(H,{key:1},{default:l(()=>[n(O,{key:"columnSettings",header:"空白列设置"},{default:l(()=>[n(v,{label:"空白列定义"},{default:l(()=>[n(x,{value:t.value.emptyColumnDefinition,"onUpdate:value":e[5]||(e[5]=o=>t.value.emptyColumnDefinition=o)},{default:l(()=>[n(m,{value:"all"},{default:l(()=>[...e[23]||(e[23]=[u("所有单元格为空",-1)])]),_:1}),n(m,{value:"data"},{default:l(()=>[...e[24]||(e[24]=[u("数据行为空（忽略格式行）",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(v,{label:"保留选项"},{default:l(()=>[n(s,{checked:t.value.keepHeaderColumn,"onUpdate:checked":e[6]||(e[6]=o=>t.value.keepHeaderColumn=o)},{default:l(()=>[...e[25]||(e[25]=[u("保留表头列",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})]),_:1})):p("",!0)]),_:1})])):p("",!0),f.value===2?(r(),k("div",oe,[e[30]||(e[30]=a("h3",null,"其他选项设置",-1)),n(T,{layout:"vertical"},{default:l(()=>[n(v,{label:"处理选项"},{default:l(()=>[n(s,{checked:t.value.ignoreHiddenSheets,"onUpdate:checked":e[7]||(e[7]=o=>t.value.ignoreHiddenSheets=o)},{default:l(()=>[...e[27]||(e[27]=[u("忽略隐藏工作表",-1)])]),_:1},8,["checked"]),n(s,{checked:t.value.ignoreFilteredRows,"onUpdate:checked":e[8]||(e[8]=o=>t.value.ignoreFilteredRows=o)},{default:l(()=>[...e[28]||(e[28]=[u("忽略已筛选行",-1)])]),_:1},8,["checked"])]),_:1}),n(v,{label:"日志记录"},{default:l(()=>[n(s,{checked:t.value.enableDetailedLogs,"onUpdate:checked":e[9]||(e[9]=o=>t.value.enableDetailedLogs=o)},{default:l(()=>[...e[29]||(e[29]=[u("启用详细日志",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})])):p("",!0),f.value===3?(r(),k("div",ue,[e[36]||(e[36]=a("h3",null,"输出目录设置",-1)),n(T,{layout:"vertical"},{default:l(()=>[n(v,{label:"输出位置"},{default:l(()=>[n(x,{value:t.value.outputLocation,"onUpdate:value":e[10]||(e[10]=o=>t.value.outputLocation=o)},{default:l(()=>[n(m,{value:"same"},{default:l(()=>[...e[31]||(e[31]=[u("与源文件相同目录",-1)])]),_:1}),n(m,{value:"custom"},{default:l(()=>[...e[32]||(e[32]=[u("自定义目录",-1)])]),_:1})]),_:1},8,["value"]),t.value.outputLocation==="custom"?(r(),k("div",ae,[n(M,{type:"default",onClick:A},{default:l(()=>[...e[33]||(e[33]=[u(" 选择输出目录 ",-1)])]),_:1}),t.value.customOutputDir?(r(),k("span",se,c(t.value.customOutputDir),1)):p("",!0)])):p("",!0)]),_:1}),n(v,{label:"文件名设置"},{default:l(()=>[n(x,{value:t.value.filenameMode,"onUpdate:value":e[11]||(e[11]=o=>t.value.filenameMode=o)},{default:l(()=>[n(m,{value:"append"},{default:l(()=>[...e[34]||(e[34]=[u("在原文件名后添加后缀",-1)])]),_:1}),n(m,{value:"custom"},{default:l(()=>[...e[35]||(e[35]=[u("使用自定义文件名",-1)])]),_:1})]),_:1},8,["value"]),t.value.filenameMode==="append"?(r(),b(C,{key:0,value:t.value.filenameSuffix,"onUpdate:value":e[12]||(e[12]=o=>t.value.filenameSuffix=o),placeholder:"请输入后缀（例如：_处理后）",style:{"margin-top":"12px"}},null,8,["value"])):p("",!0),t.value.filenameMode==="custom"?(r(),b(C,{key:1,value:t.value.customFilename,"onUpdate:value":e[13]||(e[13]=o=>t.value.customFilename=o),placeholder:"请输入自定义文件名（不包含扩展名）",style:{"margin-top":"12px"}},null,8,["value"])):p("",!0)]),_:1})]),_:1})])):p("",!0),f.value===4?(r(),k("div",ie,[e[47]||(e[47]=a("h3",null,"处理确认",-1)),a("div",re,[a("p",null,[e[37]||(e[37]=u(" 即将处理 ",-1)),a("strong",null,c(g.value.value.length),1),e[38]||(e[38]=u(" 个文件： ",-1))]),a("ul",null,[(r(!0),k(F,null,Z(g.value.value,o=>(r(),k("li",{key:o.key},c(o.name),1))),128))]),a("div",de,[e[46]||(e[46]=a("h4",null,"处理设置：",-1)),a("p",null,[e[39]||(e[39]=a("strong",null,"处理内容：",-1)),u(c(E()),1)]),a("p",null,[e[40]||(e[40]=a("strong",null,"工作表选项：",-1)),u(c($()),1)]),t.value.value.contentToRemove.includes("emptyRows")?(r(),k(F,{key:0},[a("p",null,[e[41]||(e[41]=a("strong",null,"空白行定义：",-1)),u(c(I()),1)]),a("p",null,[e[42]||(e[42]=a("strong",null,"行保留选项：",-1)),u(c(t.value.value.keepHeaderRow?"保留表头行":"不保留表头行"),1)])],64)):p("",!0),t.value.value.contentToRemove.includes("emptyColumns")?(r(),k(F,{key:1},[a("p",null,[e[43]||(e[43]=a("strong",null,"空白列定义：",-1)),u(c(N()),1)]),a("p",null,[e[44]||(e[44]=a("strong",null,"列保留选项：",-1)),u(c(t.value.value.keepHeaderColumn?"保留表头列":"不保留表头列"),1)])],64)):p("",!0),a("p",null,[e[45]||(e[45]=a("strong",null,"输出位置：",-1)),u(c(P()),1)])]),n(M,{type:"primary",size:"large",onClick:L,disabled:S.value.value},{default:l(()=>[u(c(S.value.value?"处理中...":"开始处理"),1)]),_:1},8,["disabled"])])])):p("",!0),R.value>0&&R.value<100?(r(),b(G,{key:4,percent:R.value,style:{margin:"16px 0"}},null,8,["percent"])):p("",!0),d.value.length>0?(r(),k("div",pe,[e[48]||(e[48]=a("h3",null,"处理日志",-1)),n(Q,{bordered:"","data-source":d.value,size:"small"},{renderItem:l(({item:o})=>[n(K,null,{default:l(()=>[u(c(o),1)]),_:2},1024)]),_:1},8,["data-source"])])):p("",!0)])}}},ke=Y(ve,[["__scopeId","data-v-13fc248e"]]);export{ke as default};
