import{P as x}from"./PluginTemplate-Bk8KtKqf.js";import{r as A}from"./py-lgh_vU0b.js";import{g as k}from"./plugin-DiTjGwyF.js";import{_ as y,r,b as i,h as w,d as P,w as d,g as c,e as p,i as B}from"./index-tMO3H4K7.js";const N={class:"plugin-content"},S={class:"settings-section"},V={__name:"index",setup(b){const n=r(1),e=r(null),a=r(!0),u=async()=>{const o=e.value.files;if(o.length===0)return;const t=await k("delete-macro");if(t)for(const s of o)try{const l=await A(t,{type:"single",file:s.file,fileName:s.name,settings:{deleteAllMacros:a.value}});l.success?e.value.handleFileProcessed(s,l):e.value.handleFileError(s,l.error||"处理失败")}catch(l){e.value.handleFileError(s,l.message||"处理失败")}},m=async()=>{n.value===1&&await u(),n.value++},f=o=>{e.value.addFiles(o)},v=()=>{e.value.importFromFolder()},_=()=>{e.value.showMoreActions()},h=()=>{n.value--},g=o=>{e.value.removeFile(o)};return(o,t)=>{const s=i("a-alert"),l=i("a-checkbox");return P(),w(x,{"plugin-title":"删除 Excel 中的宏","info-message":"删除Excel文件中的所有宏和VBA代码","current-step":n.value,onAddFile:f,onImportFolder:v,onMoreAction:_,onNextStep:m,onPrevStep:h,onRemoveFile:g,ref_key:"pluginTemplate",ref:e},{default:d(()=>[c("div",N,[p(s,{message:"注意事项",description:"此插件将删除Excel文件中的所有宏和VBA代码，操作不可逆，请谨慎使用。",type:"info","show-icon":"",class:"mb-4"}),c("div",S,[t[2]||(t[2]=c("h3",{class:"section-title"},"处理设置",-1)),p(l,{checked:a.value,"onUpdate:checked":t[0]||(t[0]=F=>a.value=F),disabled:""},{default:d(()=>[...t[1]||(t[1]=[B("删除所有宏和VBA代码",-1)])]),_:1},8,["checked"])])])]),_:1},8,["current-step"])}}},C=y(V,[["__scopeId","data-v-fe30d14f"]]);export{C as default};
