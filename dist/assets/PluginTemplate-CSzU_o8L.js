import{_ as W,r as w,b as a,c as v,d as r,f as u,g as o,e as t,w as s,i,t as y,k as S,p as X,h as g,y as $,z as N,L as Y,R as Z,A as ee}from"./index-ArcfRATZ.js";const te={class:"plugin-template"},se={key:0,class:"pyodide-loading"},oe={class:"loading-content"},le={key:0,class:"loading-progress"},ne={class:"top-bar"},ae={class:"plugin-title"},ie={class:"action-buttons"},re={class:"messages-container"},de={class:"file-table-container"},ue={key:0,class:"file-count-tip"},pe={class:"drop-content"},ce={class:"drop-icon"},me={key:0,class:"drop-warning"},fe={class:"bottom-bar"},ge={class:"progress-section"},ve={key:0,class:"progress-container"},ye={class:"progress-text"},ke={class:"bottom-buttons"},xe={class:"help-content"},be={__name:"PluginTemplate",props:{pluginTitle:{type:String,default:"插件功能"},infoMessage:{type:String,default:""},errorMessage:{type:String,default:""},successMessage:{type:String,default:""},currentStep:{type:Number,default:0},maxFileSize:{type:Number,default:0},isProcessing:{type:Boolean,default:!1},loadingProgress:{type:Number,default:0},progressText:{type:String,default:""}},emits:["add-file","import-folder","more-action","next-step","prev-step","remove-file","close-info","close-error","close-success","show-help"],setup(l,{expose:D,emit:V}){const c=V,m=w([]),P=w(0),f=w(!1),C=w(!1),k=w(!1);D({files:m,pyodideLoading:f});const A=[{title:"序号",dataIndex:"index",key:"index",width:80},{title:"名称",dataIndex:"name",key:"name",ellipsis:!0},{title:"状态",dataIndex:"status",key:"status",width:120},{title:"大小",dataIndex:"size",key:"size",width:100},{title:"扩展名",dataIndex:"extension",key:"extension",width:100},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180},{title:"操作",dataIndex:"actions",key:"actions",width:120,fixed:"right"}],B=()=>{c("add-file")},R=()=>{c("import-folder")},L=({key:n})=>{n==="help"?F():c("more-action",n)},O=n=>{m.value=m.value.filter(e=>e.key!==n),c("remove-file",n)},E=()=>{c("next-step")},G=()=>{c("prev-step")},F=()=>{C.value=!0,c("show-help")},H=n=>{if(n===0)return"0 Bytes";const e=1024,h=["Bytes","KB","MB","GB"],x=Math.floor(Math.log(n)/Math.log(e));return parseFloat((n/Math.pow(e,x)).toFixed(2))+" "+h[x]};return(n,e)=>{const h=a("a-spin"),x=a("a-progress"),p=a("a-button"),z=a("a-menu-item"),K=a("a-menu-divider"),U=a("a-menu"),j=a("a-dropdown"),b=a("a-step"),q=a("a-steps"),M=a("a-alert"),I=a("a-tag"),T=a("a-icon"),J=a("a-table"),Q=a("a-modal");return r(),v("div",te,[f.value?(r(),v("div",se,[o("div",oe,[t(h,{size:"large",tip:"正在初始化 Python 环境，请稍候..."}),e[8]||(e[8]=o("p",{class:"loading-subtitle"},"这可能需要几分钟时间，取决于您的网络连接",-1)),l.loadingProgress>0?(r(),v("div",le,[t(x,{percent:l.loadingProgress,"show-info":!0},null,8,["percent"])])):u("",!0)])])):u("",!0),o("div",ne,[t(p,{type:"default",icon:"arrow-left",onClick:e[0]||(e[0]=d=>n.$router.push("/"))},{default:s(()=>[...e[9]||(e[9]=[i(" 返回主面板 ",-1)])]),_:1}),o("h2",ae,y(l.pluginTitle),1),o("div",ie,[t(p,{type:"primary",icon:"plus",onClick:B,disabled:f.value,tooltip:{title:"支持 .xlsx, .xlsm 格式"}},{default:s(()=>[...e[10]||(e[10]=[i(" 添加文件 ",-1)])]),_:1},8,["disabled"]),t(p,{type:"default",icon:"folder-open",onClick:R,disabled:f.value},{default:s(()=>[...e[11]||(e[11]=[i(" 从文件夹中导入文件 ",-1)])]),_:1},8,["disabled"]),t(j,null,{overlay:s(()=>[t(U,{onClick:L},{default:s(()=>[t(z,{key:"paste"},{default:s(()=>[...e[13]||(e[13]=[i("从剪贴板读取",-1)])]),_:1}),t(z,{key:"clear"},{default:s(()=>[...e[14]||(e[14]=[i("清空列表",-1)])]),_:1}),t(K),t(z,{key:"help",onClick:F},{default:s(()=>[...e[15]||(e[15]=[i("查看帮助",-1)])]),_:1})]),_:1})]),default:s(()=>[t(p,{type:"default",disabled:f.value},{default:s(()=>[e[12]||(e[12]=i(" 更多 ",-1)),t(S(X))]),_:1},8,["disabled"])]),_:1})])]),t(q,{current:l.currentStep,class:"steps",type:"navigation",size:"small"},{default:s(()=>[t(b,{title:"选择文件",description:"选择待处理的 Excel 文件"}),t(b,{title:"设置规则",description:"配置处理规则和选项"}),t(b,{title:"其他选项",description:"设置额外参数"}),t(b,{title:"输出设置",description:"配置输出选项"}),t(b,{title:"开始处理",description:"执行处理任务"})]),_:1},8,["current"]),o("div",re,[l.infoMessage?(r(),g(M,{key:0,message:l.infoMessage,type:"info","show-icon":"",closable:"",onClose:e[1]||(e[1]=d=>n.$emit("close-info")),class:"info-alert"},null,8,["message"])):u("",!0),l.errorMessage?(r(),g(M,{key:1,message:l.errorMessage,type:"error","show-icon":"",closable:"",onClose:e[2]||(e[2]=d=>n.$emit("close-error")),class:"error-alert"},null,8,["message"])):u("",!0),l.successMessage?(r(),g(M,{key:2,message:l.successMessage,type:"success","show-icon":"",closable:"",onClose:e[3]||(e[3]=d=>n.$emit("close-success")),class:"success-alert"},null,8,["message"])):u("",!0)]),o("div",de,[m.value.length>0?(r(),v("div",ue,[t(I,{color:"blue"},{default:s(()=>[i(y(m.value.length)+" 个文件已选择",1)]),_:1}),e[16]||(e[16]=o("span",{class:"file-hint"},"支持拖拽添加更多文件",-1))])):u("",!0),t(J,{columns:A,"data-source":m.value,pagination:!1,bordered:"",size:"small","row-hoverable":!0},{bodyCell:s(({column:d,record:_})=>[d.key==="actions"?(r(),g(p,{key:0,type:"text",size:"small",onClick:_e=>O(_.key),style:{color:"#ff4d4f"},tooltip:{title:"删除文件"}},{default:s(()=>[...e[17]||(e[17]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])):d.key==="status"?(r(),g(I,{key:1,color:_.status==="success"?"green":_.status==="error"?"red":"blue"},{default:s(()=>[i(y(_.status==="success"?"已添加":_.status==="error"?"添加失败":"添加中"),1)]),_:2},1032,["color"])):u("",!0)]),empty:s(()=>[o("div",{class:N(["drop-area",{"drop-area-hover":k.value}]),onDragover:e[4]||(e[4]=$(d=>k.value=!0,["prevent"])),onDragleave:e[5]||(e[5]=$(d=>k.value=!1,["prevent"])),onDrop:e[6]||(e[6]=$(d=>k.value=!1,["prevent"]))},[o("div",pe,[o("div",ce,[t(T,{type:"cloud-upload",style:{fontSize:"64px",color:"#165dff",transition:"all 0.3s ease"},class:N({"drop-icon-hover":k.value})},null,8,["class"])]),e[19]||(e[19]=o("p",{class:"drop-title"},"拖拽文件到此处",-1)),e[20]||(e[20]=o("p",{class:"drop-subtitle"},"或",-1)),t(p,{type:"primary",icon:"plus",onClick:B,size:"large"},{default:s(()=>[...e[18]||(e[18]=[i(" 选择文件 ",-1)])]),_:1}),e[21]||(e[21]=o("p",{class:"drop-hint"},"支持 .xlsx, .xlsm 格式文件，可批量添加",-1)),l.maxFileSize>0?(r(),v("p",me,[t(T,{type:"exclamation-circle",style:{marginRight:"4px"}}),i("单个文件大小限制："+y(H(l.maxFileSize)),1)])):u("",!0)])],34)]),_:1},8,["data-source"])]),o("div",fe,[o("div",ge,[P.value>0?(r(),v("div",ve,[t(x,{percent:P.value,"show-info":!0,status:"active"},null,8,["percent"]),o("span",ye,y(l.progressText),1)])):u("",!0)]),o("div",ke,[t(p,{type:"default",size:"large",onClick:G,disabled:l.currentStep===0||f.value,style:{"margin-right":"16px"}},{default:s(()=>[t(S(Y)),e[22]||(e[22]=i(" 上一步 ",-1))]),_:1},8,["disabled"]),t(p,{type:"primary",size:"large",onClick:E,disabled:m.value.length===0||f.value,loading:l.isProcessing},{icon:s(()=>[l.isProcessing?(r(),g(h,{key:0})):(r(),g(S(Z),{key:1}))]),default:s(()=>[i(" "+y(l.isProcessing?"处理中...":"下一步"),1)]),_:1},8,["disabled","loading"])])]),t(Q,{open:C.value,"onUpdate:open":e[7]||(e[7]=d=>C.value=d),title:"使用帮助",footer:null,width:800},{default:s(()=>[o("div",xe,[ee(n.$slots,"help-content",{},()=>[e[23]||(e[23]=o("p",null,"该插件的帮助文档正在准备中...",-1))],!0)])]),_:3},8,["open"])])}}},he=W(be,[["__scopeId","data-v-5898dc6d"]]);export{he as P};
