import{P as w}from"./PluginTemplate-CSzU_o8L.js";import{r as N}from"./py-Dmvp32T8.js";import{g as E}from"./plugin-DiTjGwyF.js";import{_ as S,r as p,b as f,h as T,d as A,w as o,g,e as l,i as u}from"./index-ArcfRATZ.js";const R={class:"plugin-content"},j={class:"settings-section"},k={__name:"index",setup(B){const m=p(1),a=p(null),d=p("original"),c=p("sheet_index"),_=async()=>{const r=a.value.files;if(r.length===0)return;const e=await E("extract-images");if(e)for(const s of r)try{const t=await N(e,{type:"single",file:s.file,fileName:s.name,settings:{outputFormat:d.value,namingRule:c.value}});if(t.success)if(t.results&&t.results.length>0)for(const n of t.results){let i="image/png";n.format==="jpg"||n.format==="jpeg"?i="image/jpeg":n.format==="gif"?i="image/gif":n.format==="bmp"&&(i="image/bmp"),a.value.handleFileProcessed({...s,name:n.file_name,mimeType:i},{...t,buffer:n.buffer})}else a.value.handleFileError(s,"未提取到任何图片");else a.value.handleFileError(s,t.error||"提取失败")}catch(t){a.value.handleFileError(s,t.message||"提取失败")}},F=async()=>{m.value===1&&await _(),m.value++},x=r=>{a.value.addFiles(r)},y=()=>{a.value.importFromFolder()},P=()=>{a.value.showMoreActions()},h=()=>{m.value--},b=r=>{a.value.removeFile(r)};return(r,e)=>{const s=f("a-alert"),t=f("a-select-option"),n=f("a-select"),i=f("a-form-item");return A(),T(w,{"plugin-title":"提取 Excel 文档中的图片","info-message":"从Excel文档中提取所有图片并保存为单独文件","current-step":m.value,onAddFile:x,onImportFolder:y,onMoreAction:P,onNextStep:F,onPrevStep:h,onRemoveFile:b,ref_key:"pluginTemplate",ref:a},{default:o(()=>[g("div",R,[l(s,{message:"提取说明",description:"支持从Excel文档中提取所有图片，包括嵌入在工作表中的图片。提取的图片将保持原始格式或转换为PNG格式。",type:"info","show-icon":"",class:"mb-4"}),g("div",j,[e[8]||(e[8]=g("h3",{class:"section-title"},"提取设置",-1)),l(i,{label:"输出格式"},{default:o(()=>[l(n,{value:d.value,"onUpdate:value":e[0]||(e[0]=v=>d.value=v),placeholder:"请选择输出格式"},{default:o(()=>[l(t,{value:"original"},{default:o(()=>[...e[2]||(e[2]=[u("保持原始格式",-1)])]),_:1}),l(t,{value:"png"},{default:o(()=>[...e[3]||(e[3]=[u("统一转换为PNG",-1)])]),_:1}),l(t,{value:"jpg"},{default:o(()=>[...e[4]||(e[4]=[u("统一转换为JPG",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),l(i,{label:"图片命名规则"},{default:o(()=>[l(n,{value:c.value,"onUpdate:value":e[1]||(e[1]=v=>c.value=v),placeholder:"请选择图片命名规则"},{default:o(()=>[l(t,{value:"sheet_index"},{default:o(()=>[...e[5]||(e[5]=[u("工作表_序号",-1)])]),_:1}),l(t,{value:"original"},{default:o(()=>[...e[6]||(e[6]=[u("原始文件名",-1)])]),_:1}),l(t,{value:"index"},{default:o(()=>[...e[7]||(e[7]=[u("仅序号",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),l(s,{message:"提示",description:"提取的图片将以单个文件形式返回，可直接下载使用。",type:"success","show-icon":"",class:"mt-4"})])])]),_:1},8,["current-step"])}}},C=S(k,[["__scopeId","data-v-078e0302"]]);export{C as default};
